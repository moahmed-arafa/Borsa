{% include 'header.html' %}
<!-- /page content -->
<div class="right_col" role="main">
    <!--<h1>-->
    <!--{ shop.shop_name }} <a href="{url_for('website.edit_shop', shop_id=shop.id)}}">Edit Shop</a>-->
    <!--</h1>-->
    <div class="">
        <div class="page-title">
            <div class="title_left">
                <h3>Products</h3>
            </div>

            <div class="title_right">
                <div class="col-md-5 col-sm-5 col-xs-12 form-group pull-right top_search">
                    <div class="input-group">
                        <input id="datatable-search" type="text" class="form-control"
                               placeholder="Search for...">
                    <span class="input-group-btn">
                      <button class="btn btn-default" type="button">Go!</button>
                    </span>
                    </div>
                </div>
            </div>
        </div>

        <div class="clearfix"></div>

        <div class="col-md-12 col-sm-12 col-xs-12">
            <div class="x_panel">
                <div class="x_title">
                    <h2>Products List
                        <small>Products</small>
                    </h2>
                    <ul class="nav navbar-right panel_toolbox">
                        <li><a class="collapse-link"><i class="fa fa-chevron-up"></i></a>
                        </li>
                        <li class="dropdown">
                            <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button"
                               aria-expanded="false"><i class="fa fa-wrench"></i></a>
                            <ul class="dropdown-menu" role="menu">
                                <li><a href="#">Settings 1</a>
                                </li>
                                <li><a href="#">Settings 2</a>
                                </li>
                            </ul>
                        </li>
                        <li><a class="close-link"><i class="fa fa-close"></i></a>
                        </li>
                    </ul>
                    <div class="clearfix"></div>
                </div>
                <div class="x_content">
                    <p class="text-muted font-13 m-b-30">
                        Products list to view and edit.
                    </p>
                    <table id="datatable" class="display table table-striped table-bordered">
                        <thead>
                        <tr>
                            <th>ID</th>
                            <th>Stock</th>
                            <th>User</th>
                            <th>Status</th>
                            <th>Value</th>
                            <th>No.</th>
                            <th>Total</th>
                        </tr>
                        </thead>

                        <tfoot>
                        <tr>
                            <th>ID</th>
                            <th>Stock</th>
                            <th>User</th>
                            <th>Status</th>
                            <th></th>
                            <th></th>
                            <th></th>
                        </tr>
                        </tfoot>

                        <tbody>
                        {% for item in items %}
                        <tr>
                            <td>
                                <a title="Confirm Request"
                                   onclick="return confirm('Are you sure you would like to Confirm this ID {{ item.id }} ?');"
                                   href="{{url_for('website.stock_request_confirm', stock_request_id=item.id)}}">
                                    {{ item.id }}
                                    {% if item.type == 1 %}
                                    <small>Buy</small>
                                    {% elif item.type == 0 %}
                                    <small>Sell</small>
                                    {% endif %} </a>
                            </td>
                            <td>{{ item.stock.company.symbol }}</td>
                            <td>{{ item.customer.first_name }} {{ item.customer.last_name }}</td>
                            <td>
                                {% if item.broker %}
                                Confirmed
                                {% else %}
                                Pending
                                {% endif %}
                            </td>
                            <td>{{ item.value.value }} EGP</td>
                            <td>
                                {{ item.no_stocks }}
                            </td>
                            <td>
                                {{ item.no_stocks*item.value.value }} EGP
                            </td>
                        </tr>
                        {% endfor %}
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>
</div>
<!-- /page content -->
<!-- footer content -->
<footer>
    <div class="pull-right">
        ZeOwls ltd<a href="https://ZeOwls.com">ZeOwls.com</a>
    </div>
    <div class="clearfix"></div>
</footer>
<!-- /footer content -->
</div>
</div>

<!-- jQuery -->
<script src="{{url_for('static', filename='vendors/jquery/dist/jquery.min.js')}}"></script>
<!-- Bootstrap -->
<script src="{{url_for('static', filename='vendors/bootstrap/dist/js/bootstrap.min.js')}}"></script>
<!-- FastClick -->
<script src="{{url_for('static', filename='vendors/fastclick/lib/fastclick.js')}}"></script>
<!-- NProgress -->
<script src="{{url_for('static', filename='vendors/nprogress/nprogress.js')}}"></script>
<!-- iCheck -->
<script src="{{url_for('static', filename='vendors/iCheck/icheck.min.js')}}"></script>
<!-- Datatables -->
<script src="{{url_for('static', filename='vendors/datatables.net/js/jquery.dataTables.min.js')}}"></script>
<script src="{{url_for('static', filename='vendors/datatables.net-bs/js/dataTables.bootstrap.min.js')}}"></script>
<script src="{{url_for('static', filename='vendors/datatables.net-buttons/js/dataTables.buttons.min.js')}}"></script>
<script src="{{url_for('static', filename='vendors/datatables.net-buttons-bs/js/buttons.bootstrap.min.js')}}"></script>
<script src="{{url_for('static', filename='vendors/datatables.net-buttons/js/buttons.flash.min.js')}}"></script>
<script src="{{url_for('static', filename='vendors/datatables.net-buttons/js/buttons.html5.min.js')}}"></script>
<script src="{{url_for('static', filename='vendors/datatables.net-buttons/js/buttons.print.min.js')}}"></script>
<script src="{{url_for('static', filename='vendors/datatables.net-fixedheader/js/dataTables.fixedHeader.min.js')}}"></script>
<script src="{{url_for('static', filename='vendors/datatables.net-keytable/js/dataTables.keyTable.min.js')}}"></script>
<script src="{{url_for('static', filename='vendors/datatables.net-responsive/js/dataTables.responsive.min.js')}}"></script>
<script src="{{url_for('static', filename='vendors/datatables.net-responsive-bs/js/responsive.bootstrap.js')}}"></script>
<script src="{{url_for('static', filename='vendors/datatables.net-scroller/js/dataTables.scroller.min.js')}}"></script>
<script src="{{url_for('static', filename='vendors/jszip/dist/jszip.min.js')}}"></script>
<script src="{{url_for('static', filename='vendors/pdfmake/build/pdfmake.min.js')}}"></script>
<script src="{{url_for('static', filename='vendors/pdfmake/build/vfs_fonts.js')}}"></script>

<!-- Custom Theme Scripts -->
<script src="{{url_for('static', filename='build/js/custom.min.js')}}"></script>

<!-- Datatables -->
<script type="text/javascript" charset="utf-8">
    $(document).ready(function () {

        // Setup - add a text input to each footer cell
        $('#datatable tfoot th').each(function () {
            var title = $(this).text();
            if (title != "") {
                $(this).html('<input type="text" placeholder="Search ' + title + '" />');
            }
        });

//        console.log(data);

        var table = $("#datatable").DataTable({
            dom: "Bfrtip",
            buttons: [
                {
                    extend: "copy",
                    className: "btn-sm"
                },
                {
                    extend: "csv",
                    className: "btn-sm"
                },
                {
                    extend: "excel",
                    className: "btn-sm"
                },
                {
                    extend: "pdfHtml5",
                    className: "btn-sm"
                },
                {
                    extend: "print",
                    className: "btn-sm"
                }
            ],
            fixedHeader: true,
            responsive: true,
//            data: data,
//            columns: [
//                {data: 'id'},
//                {data: 'code'},
//                {data: 'description'},
//                {data: 'price'}
//            ]
//            "processing": true,
//            "serverSide": true,
//            "ajax": "{{ url_for('website.list_companies_data') }}"
        });

        // Apply the search
        table.columns().every(function () {
            var that = this;
            $('input', this.footer()).on('keyup change', function () {
                if (that.search() !== this.value) {
                    that.search(this.value).draw();
                }
            });
        });

        $('#datatable tbody tr').click(function () {
            var aData = table.fnGetData(this);
            alert(aData[0]); // assuming the id is in the first column
        });


        TableManageButtons = function () {
            "use strict";
            return {
                init: function () {
//                    handleDataTableButtons();
                }
            };
        }();

//        $('#datatable').dataTable();

        $('#datatable-keytable').DataTable({
            keys: true
        });

        $('#datatable-responsive').DataTable();

        $('#datatable-scroller').DataTable({
            ajax: "js/datatables/json/scroller-demo.json",
            deferRender: true,
            scrollY: 380,
            scrollCollapse: true,
            scroller: true
        });

        $('#datatable-fixed-header').DataTable({
            fixedHeader: true
        });

        var $datatable = $('#datatable-checkbox');

        $datatable.dataTable({
            'order': [[1, 'asc']],
            'columnDefs': [
                {orderable: false, targets: [0]}
            ]
        });

        $datatable.on('draw.dt', function () {
            $('input').iCheck({
                checkboxClass: 'icheckbox_flat-green'
            });
        });

        TableManageButtons.init();
    });
</script>
<!-- /Datatables -->
</body>
</html>